
<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>ZenVue Slider Scroll Intégré</title>
  <style>
    * {
      box-sizing: border-box;
    }
    html, body {
      margin: 0;
      padding: 0;
      background: #111;
      font-family: sans-serif;
    }
    section {
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      color: white;
      font-size: 2em;
    }
    .slider-section {
      position: relative;
      height: 100vh;
      overflow: hidden;
    }
    .container {
      position: sticky;
      top: 0;
      width: 980px;
      height: 551px;
      margin: auto;
      overflow: hidden;
      border: 2px solid white;
    }
    .image-wrapper {
      position: absolute;
      top: 0;
      left: 0;
      width: 980px;
      height: 551px;
    }
    .after-img, .before-img {
      position: absolute;
      width: 980px;
      height: 551px;
      object-fit: cover;
      top: 0;
      left: 0;
      transition: clip-path 0.3s ease;
    }
    .slider-line {
      position: absolute;
      top: 0;
      bottom: 0;
      width: 2px;
      background: white;
      z-index: 2;
      transition: left 0.3s ease;
    }
  </style>
</head>
<body>

<section>Avant le slider</section>

<div class="slider-section" id="sliderZone">
  <div class="container" id="slider">
    <div class="image-wrapper">
      <img src="after.jpg" class="after-img">
      <img src="before.jpg" class="before-img" id="beforeImage">
      <div class="slider-line" id="sliderLine"></div>
    </div>
  </div>
</div>

<section>Après le slider</section>

<script>
  let revealPercent = 75;
  const beforeImg = document.getElementById("beforeImage");
  const sliderLine = document.getElementById("sliderLine");
  const sliderZone = document.getElementById("sliderZone");

  beforeImg.style.clipPath = "inset(0 " + (100 - revealPercent) + "% 0 0)";
  sliderLine.style.left = revealPercent + "%";

  let isSliderActive = false;

  function shouldActivateSlider() {
    const rect = sliderZone.getBoundingClientRect();
    return rect.top <= 300 && rect.bottom >= 0;
  }

  window.addEventListener("scroll", () => {
    isSliderActive = shouldActivateSlider();
  });

  window.addEventListener("wheel", (event) => {
    if (!isSliderActive) return;

    let shouldBlock = false;

    if (event.deltaY > 0 && revealPercent > 0) {
      revealPercent -= 7;
      shouldBlock = true;
    } else if (event.deltaY < 0 && revealPercent < 100) {
      revealPercent += 7;
      shouldBlock = true;
    }

    revealPercent = Math.max(0, Math.min(100, revealPercent));
    const percentRight = 100 - revealPercent;
    beforeImg.style.clipPath = "inset(0 " + percentRight + "% 0 0)";
    sliderLine.style.left = revealPercent + "%";

    // Bloque le scroll seulement pendant la transition du curseur
    if (shouldBlock) {
      event.preventDefault();
    }
  }, { passive: false });
</script>

</body>
</html>
